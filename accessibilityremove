Add-Type -TypeDefinition @"
using System;
using System.Runtime.InteropServices;
public class Keyboard {
    [DllImport("user32.dll")]
    public static extern short GetAsyncKeyState(int vKey);
}
"@ -Language CSharp

Write-Host "Press SPACEBAR to output ';0600755597?'. Press ESC to exit."

while ($true) {
    if ([Keyboard]::GetAsyncKeyState(0x20) -ne 0) {  # SPACEBAR (0x20)
        Write-Host ";0600755597?"
        Start-Sleep -Milliseconds 200
    }
    if ([Keyboard]::GetAsyncKeyState(0x1B) -ne 0) {  # ESC (0x1B)
        Write-Host "Exiting..."
        break
    }
    Start-Sleep -Milliseconds 50
}
